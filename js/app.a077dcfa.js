(function(){var e={8374:function(e,t,o){"use strict";var r=o(15361),a=o(16281),n=o(49242),s=o(73396);function i(e,t,o,r,a,n){const i=(0,s.up)("router-view"),l=(0,s.up)("main-layout");return a.isReady?((0,s.wg)(),(0,s.j4)(l,{key:0,title:a.title},{default:(0,s.w5)((()=>[(0,s.Wm)(i)])),_:1},8,["title"])):(0,s.kq)("",!0)}o(57658);var l=o(44870);function u(e,t,o,r,a,n){const i=(0,s.up)("robo-layout-header");return(0,s.wg)(),(0,s.j4)(i,{logoIcon:"images/logo-white.png",navigation:a.navigation,title:o.title,version:a.version},null,8,["navigation","title","version"])}var c=o(7464),d=o.n(c);function p(e){return new(d())(e.toString())}function m(e,t){return p(e).todp(t)}function w(e,t=0,o){return p(e).div(new(d())(10).pow(t.toString())).todp(o).toString()}d().set({toExpNeg:-31,toExpPos:31});var v=o(44161),f={props:{title:{type:String,default:"Robonomics Dapp"}},inject:["RobonomicsProvider"],data(){return{navigation:[{title:"Other",links:[{title:"Services",link:this.$router.resolve({name:"services"}).path,type:"router"}]},{title:"Tokenomics",links:[{title:"Uniswap",link:"https://app.uniswap.org/#/swap?inputCurrency=0x7de91b204c1c737bcee6f000aaa6569cf7061cb7&outputCurrency=0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2",type:"external"},{title:"About XRT",link:"https://robonomics.network/xrt/",type:"external"}]},{title:"Tools",links:[{title:"Substrate Portal",link:"https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fkusama.rpc.robonomics.network%2F#/explorer",type:"external"},{title:"Subscan",link:"https://robonomics.subscan.io/",type:"external"},{title:"Polkassembly",link:"https://robonomics.polkassembly.io/",type:"external"}]},{title:"Kusama XCM",links:[{title:"Moonriver",link:"https://apps.moonbeam.network/moonriver",type:"external"},{title:"Solarbeam",link:"https://analytics.solarbeam.io/pairs/0x5261e0ce96289e6c3a16da45a2e52d1ab1a0e9c3",type:"external"}]}],version:" "}},computed:{robonomics:function(){return(0,l.IU)(this.RobonomicsProvider.instance.value)}},watch:{"$store.state.robonomicsUIvue.polkadot.extensionObj":function(e){e.signer&&e.signer.signRaw&&this.$store.state.robonomicsUIvue.polkadot.address&&this.handlerAccount(this.$store.state.robonomicsUIvue.polkadot.address)},"$store.state.robonomicsUIvue.polkadot.address":{handler:function(e){e&&this.$store.state.robonomicsUIvue.polkadot.extensionObj.signer&&this.$store.state.robonomicsUIvue.polkadot.extensionObj.signer.signRaw&&this.handlerAccount(e)},immediate:!0}},async created(){try{const e=await v.Z.get("https://api.github.com/repos/airalab/dapp.robonomics.network/releases/latest");e.data.tag_name&&(this.version=e.data.tag_name)}catch(e){console.log("dApp version not found.")}},methods:{async handlerAccount(e){this.unsubscribeBalance&&this.unsubscribeBalance();const t=this.$store.state.robonomicsUIvue.polkadot.accounts.find((t=>t.address===e));t&&(await this.robonomics.accountManager.setSender(e,{type:t.type,extension:this.$store.state.robonomicsUIvue.polkadot.extensionObj}),this.unsubscribeBalance=await this.robonomics.account.getBalance(e,(e=>{const t=e.free.sub(e.feeFrozen);this.$store.commit("polkadot/setBalanceXRT",m(w(t,this.robonomics.api.registry.chainDecimals[0]),4))})))}}},h=o(40089);const g=(0,h.Z)(f,[["render",u]]);var b=g,y={__name:"Main",props:{title:{type:String,default:"Robonomics Dapp"}},setup(e){const t=e;return(e,o)=>{const r=(0,s.up)("robo-layout");return(0,s.wg)(),(0,s.j4)(r,null,{default:(0,s.w5)((()=>[(0,s.Wm)((0,l.SU)(b),{title:t.title},null,8,["title"]),(0,s.WI)(e.$slots,"default")])),_:3})}}};const k=y;var U=k,_=o(55743),W=o.n(_),S={name:"App",inject:["RobonomicsProvider","IpfsProvider"],components:{MainLayout:U},data(){return{isReady:this.RobonomicsProvider.isReady,title:""}},computed:{robonomics:function(){return(0,l.IU)(this.RobonomicsProvider.instance.value)}},watch:{$route:{handler:function(e){this.title=e?.meta?.title,document.title=this.title?`${this.title} – Robonomics Network dApp`:"Robonomics Network dApp"},deep:!0,immediate:!0},isReady:{handler:async function(e){e&&this.init()},immediate:!0}},async created(){this.$store.commit("rws/setKey","88tHsnwjp*p36AurOu28W6UZz"),this.$store.dispatch("rws/init"),this.$store.commit("rws/setLinkActivate",this.$router.resolve({name:"rwsActivate"}).path),this.$store.commit("rws/setLinkList",this.$router.resolve({name:"rwsSetupsList"}).path),this.$store.commit("rws/setLinkSetup",this.$router.resolve({name:"rwsSetup"}).path),this.$store.commit("rws/setLinkDevices",this.$router.resolve({name:"telemetry"}).path),this.$store.commit("rws/setLinkUsers",this.$router.resolve({name:"rwsUsersList"}).path),this.$store.commit("rws/setLinkUseractivate",this.$router.resolve({name:"rwsUserSetup"}).path),this.$store.commit("rws/setLinkHaSetup",this.$router.resolve({name:"haSetup"}).path),this.$store.commit("ipfs/setGateways",this.IpfsProvider.gateways)},methods:{async init(){if(this.$store.state.robonomicsUIvue.rws.list&&this.$store.state.robonomicsUIvue.rws.list.length>0){const e=async(e,t)=>{const o=W()().valueOf(),r=Number(t);if(o&&r&&r-o<0){const t=await this.robonomics.rws.getLedger(e);if(!t.isEmpty){if(null===t.value)return"";const e=t.value.issueTime.toNumber();let o=0;t.value.kind.isDaily&&(o=t.value.kind.value.days.toNumber());const r=864e5;return e+o*r}}return t},t=[];for(const o of this.$store.state.robonomicsUIvue.rws.list)t.push({...o,enddate:await e(o.owner,o.enddate)});this.$store.dispatch("rws/rewrite",t)}}}};const x=(0,h.Z)(S,[["render",i]]);var A=x,H=o(38779);class I{constructor(e){this.endpoint=e,this.authHeader=null,this.robonomics=null,this._create()}_create(){this.client=(0,H.Ue)({...this._options()})}_options(){return{url:this.endpoint,headers:{authorization:`Basic ${this.authHeader}`,robonomics:this.robonomics}}}isAuth(){return!!this.authHeader&&!!this.robonomics}auth(e,t,o){const r=`sub-${t}:${o}`;this.authHeader=Buffer.from(r).toString("base64"),this.robonomics=e,this._create()}authClear(){this.authHeader=null,this.robonomics=null,this._create()}async ls(e){const t=[];for await(const o of this.client.ls(e))"file"===o.type&&t.push(o);return t}async cat(e){const t=async e=>{const t=new TextDecoder;let o="";for await(const r of this.client.cat(e))o+=t.decode(r,{stream:!0});return o};return await t(e)}async add(e){return await this.client.add(e)}async catViaGateway(e,t,o=5){for(let a=1;a<=o;a++)try{return(await v.Z.get(`${e}${t}`)).data}catch(r){console.log(r)}throw new Error("File not available")}async catViaGateways(e,t){for(const r of e)try{return{gateway:r,result:await this.catViaGateway(r,t)}}catch(o){console.log(o.message)}throw new Error("File not available")}}var R={install:(e,t)=>{const o=(0,l.iH)();e.provide("IpfsProvider",{instance:o,gateways:t.gateways||[]}),o.value=new I(t.api.gateway)}},N=o(83153),O=o(46142),C=o(76117),j=o(50142);class $ extends O.Uk{constructor(e,t={},o=null){super(e,o),this.extension=null,e.loadAll(t),this.setReady(!0)}async beforeSetSender(e,{type:t,extension:o}){this.extension=o;try{this.keyring.getPair(e)}catch(r){this.keyring.loadInjected(e,{},t)}}async afterSetSender(){this.account.meta.isInjected&&this.extension&&(this.api.setSigner(this.extension.signer),this.account.signMsg=async e=>(await this.extension.signer.signRaw({address:this.account.address,data:(0,C.c)((0,j.Rl)(e)),type:"bytes"})).signature)}}var P={install:async(e,t)=>{const o=(0,l.iH)(!1),r=(0,l.qj)({value:void 0});e.provide("RobonomicsProvider",{isReady:o,instance:r}),r.value=await O.l.createInstance(t),(0,l.IU)(r).value.setAccountManager(new $(N.ZP)),o.value=!0}},M=o(22483),D=o(20065),Y={__name:"Home",setup(e){const t=(0,D.oR)(),o=(0,s.Fl)((()=>t.state.robonomicsUIvue.rws.list));return(e,r)=>{const a=(0,s.up)("robo-video"),n=(0,s.up)("robo-icon"),i=(0,s.up)("robo-text"),u=(0,s.up)("robo-grid"),c=(0,s.up)("robo-button"),d=(0,s.up)("robo-card"),p=(0,s.up)("robo-link"),m=(0,s.up)("robo-grid-item"),w=(0,s.up)("robo-layout-section");return(0,s.wg)(),(0,s.j4)(w,null,{default:(0,s.w5)((()=>[(0,s.Wm)(u,{offset:"x0",gap:"x1",valign:"start",galign:"start",minColumnWidth:"550px",maxColumnWidth:"1fr"},{default:(0,s.w5)((()=>[(0,s.Wm)(a,{autoplay:"",loop:"",sources:[{src:"https://crustipfs.art/ipfs/QmStCDsEHCYwVYvnDdmZBMnobPmrgZx3iJLm65b8XNzKQa",type:"video/mp4"}],script:"<p>Robonomics is a decentralized cloud service that can be used to enhance\n                your smart home system. It addresses two main problems: the lack of\n                control over data shared with vendors or third parties, and the vulnerability of\n                smart homes to centralized cloud server shutdowns.</p>\n                <p>With Robonomics, you can take advantage of its secure,\n                  serverless, and decentralized cloud service to improve the functionality of\n                  your smart home. Plus, you can use it with a wide range of Zigbee smart devices\n                  to automate and control various aspects of your home.</p>\n                <p>Installing Robonomics on top of Home Assistant is easy, and there are\n                   several options to choose from. Simply select the method that works best for you\n                   and your smart home on wiki.robonomics.network.</p>"},null,8,["sources"]),(0,s.Wm)(m,{align:"stretch"},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{offset:"x0",gap:"x1",minColumnWidth:"270px",maxColumnWidth:"1fr"},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{fixedButton:""},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{offset:"x0",gap:"x05",valign:"start"},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{icon:"current-version",size:"big"}),(0,s._)("div",null,[(0,s.Wm)(i,{title:"4"},{default:(0,s.w5)((()=>[(0,s.Uk)("Your RWS subscriptions")])),_:1})])])),_:1}),(0,s.Wm)(c,{router:(0,l.SU)(t).state.robonomicsUIvue.rws.links.list},{default:(0,s.w5)((()=>[(0,s.Uk)(" View details ")])),_:1},8,["router"])])),_:1}),(0,s.Wm)(d,{pale:o.value?.length<1,fixedButton:""},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{offset:"x0",gap:"x05",valign:"start"},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{icon:"plug",size:"big"}),(0,s._)("div",null,[(0,s.Wm)(i,{title:"4"},{default:(0,s.w5)((()=>[(0,s.Uk)("Control smart devices")])),_:1})])])),_:1}),(0,s.Wm)(c,{router:(0,l.SU)(t).state.robonomicsUIvue.rws.links.devices,disabled:o.value?.length<1},{default:(0,s.w5)((()=>[(0,s.Uk)(" Manage devices ")])),_:1},8,["router","disabled"])])),_:1},8,["pale"]),(0,s.Wm)(d,{pale:o.value?.length<1,fixedButton:""},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{offset:"x0",gap:"x05",valign:"start"},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{icon:"user-group",size:"big"}),(0,s._)("div",null,[(0,s.Wm)(i,{title:"4"},{default:(0,s.w5)((()=>[(0,s.Uk)("Share your telemetry")])),_:1})])])),_:1}),(0,s.Wm)(c,{router:(0,l.SU)(t).state.robonomicsUIvue.rws.links.users,disabled:o.value?.length<1},{default:(0,s.w5)((()=>[(0,s.Uk)(" Manage Users ")])),_:1},8,["router","disabled"])])),_:1},8,["pale"]),(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{title:"4",offset:"x0"},{default:(0,s.w5)((()=>[(0,s.Uk)("Need help?")])),_:1}),(0,s.Wm)(u,{gap:"x05",offset:"x1"},{default:(0,s.w5)((()=>[(0,s.Wm)(i,{size:"small",weight:"bold"},{default:(0,s.w5)((()=>[(0,s.Wm)(p,{href:"https://wiki.robonomics.network"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Wiki ")])),_:1}),(0,s.Uk)(" - Tutorials ")])),_:1}),(0,s.Wm)(i,{size:"small",weight:"bold"},{default:(0,s.w5)((()=>[(0,s.Wm)(p,{href:"https://github.com/airalab/dapp.robonomics.network"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Github")])),_:1}),(0,s.Uk)(" - Bugs & improvements ")])),_:1}),(0,s.Wm)(i,{size:"small",weight:"bold"},{default:(0,s.w5)((()=>[(0,s.Wm)(p,{href:"https://discord.gg/JpaN2XAmqY"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Discord ")])),_:1}),(0,s.Uk)(" - Team support ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}}};const F=Y;var T=F,L={created:function(){window.location.href=`https://v0.dapp.robonomics.network/${this.$route.href}`}};const E=L;var z=E;function B(e,t,o,r,a,n){const i=(0,s.up)("robo-template-rws-activate"),l=(0,s.up)("robo-layout-section");return(0,s.wg)(),(0,s.j4)(l,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{price:r.price,activationtime:"2",available:r.freeAuctions,onOnActivate:r.onActivate,rwsStatus:r.status,rwsMessage:r.message},null,8,["price","available","onOnActivate","rwsStatus","rwsMessage"])])),_:1})}function q(){const{instance:e}=(0,s.f3)("RobonomicsProvider");return(0,l.IU)(e).value}const Z=()=>{const e=(0,l.iH)(null),t=q();t.accountManager.account&&(e.value=t.accountManager.account.address);const o=t.accountManager.onChange((t=>{e.value=t.address}));return{account:e,unsubscribe:o}},V=e=>{const t=(0,l.iH)(null),o=q();let r;return(0,s.YP)(e,(async()=>{r&&r(),r=await o.account.getBalance(e.value,(e=>{t.value=e.free.sub(e.feeFrozen).toNumber()}))})),{balance:t,unsubscribe:r}};var J=o(37281);const G=(e=null)=>{const t=q(),o=(0,l.iH)(e),r=(0,l.iH)([]),a=async()=>{if(o.value)try{(0,J.Y)(o.value);const e=await t.rws.getDevices(o.value);return void(r.value=e.map((e=>e.toHuman())))}catch(e){console.log(e)}r.value=[]};return(0,s.YP)(o,(async()=>{await a()}),{immediate:!0}),{owner:o,devices:r,loadDevices:a}},K=(e=null)=>{const t=(0,l.iH)(e),o=(0,l.qj)({value:null}),r=q(),{devices:a,loadDevices:n}=G(t),i=()=>r.api.consts.rws.referenceCallWeight,u=async e=>{const t=await r.rws.getLedger(e);if(!t.isEmpty)return t.value},c=864e5,d=async e=>{const t=await u(e);if(!t)return-1;const o=t.freeWeight.toNumber(),r=t.lastUpdate.toNumber(),a=t.issueTime.toNumber(),n=i(),s=Date.now();let l=(()=>{let e;if(t.kind.isLifetime)e=t.kind.value.tps.toNumber();else{const o=t.kind.value.days.toNumber(),r=o*c;e=s<a+r?1e4:0}return e})();const d=s-r;return Math.floor(o+n*l*d/1e9)},p=(0,s.Fl)((()=>{if(null===o.value)return"";const e=(0,l.IU)(o);if(e.value.kind.isLifetime)return null;const t=e.value.issueTime.toNumber();let r=0;return e.value.kind.isDaily&&(r=e.value.kind.value.days.toNumber()),t+r*c})),m=(0,s.Fl)((()=>{if(null===o.value)return 0;const e=(0,l.IU)(o);let t=0;return e.value.kind.isDaily&&(t=e.value.kind.value.days.toNumber()),t/30})),w=(0,s.Fl)((()=>!(null===o.value||null!==p.value&&Date.now()>p.value))),v=(0,s.Fl)((()=>null!==o.value)),f=async()=>{if(t.value)try{(0,J.Y)(t.value);const e=await u(t.value);if(e)return void(o.value=e)}catch(e){console.log(e)}o.value=null};return(0,s.YP)(t,(async()=>{await f()}),{immediate:!0}),{owner:t,dataRaw:o,hasSubscription:v,isActive:w,countMonth:m,validUntil:p,loadLedger:f,devices:a,loadDevices:n,getFreeWeightCalc:d}},X=()=>{const e=q(),{getFreeWeightCalc:t}=K(),o=async(t,o)=>{if(!o){if(!e.accountManager.account)throw new Error("Signer required");o=e.accountManager.account.address}return(await t.paymentInfo(o)).weight.toNumber()},r=async(e,r)=>{const a=await t(r);if(a<0)throw new Error(`Not found ledger ${r}`);const n=await o(e);if(n>a)throw new Error(`The origin account have no enough free weight to process these call. Call weight ${n}, Free weight ${a}`)},a=()=>{const e=(0,l.iH)(null),t=(0,l.iH)(null),o=(0,l.iH)(!1);return{error:t,process:o,result:e}},n=async(t,o,a=!1)=>{t.result.value=null,t.error.value=null,t.process.value=!0;try{a&&(await r(o,a),e.accountManager.useSubscription(a));const n=await e.api.rpc.system.accountNextIndex(e.accountManager.account.address);t.result.value=await e.accountManager.signAndSend(o,{nonce:n}),console.log("tx",t.result.value.block,t.result.value.tx)}catch(n){console.log(n),t.error.value=n.message}return t.process.value=!1,a&&e.accountManager.useSubscription(!1),t.result};return{createTx:a,send:n}};var Q=o(51737),ee={setup(){const e=(0,l.iH)(0),t=(0,l.iH)(0),o=(0,l.iH)("new"),r=(0,l.iH)("");let a=null;const n=q(),{account:i,unsubscribe:u}=Z(),{balance:c,unsubscribe:d}=V(i),p=K(i),m=G(i);(0,s.YP)([p.hasSubscription,p.isActive,i],(()=>{p.hasSubscription.value?p.isActive.value?(o.value="ok",r.value="You already have subsription"):(o.value="renew",r.value=""):(o.value="new",r.value="")})),(async()=>{t.value=(await n.rws.getFreeAuctions()).length,a=await n.events.onBlock((async()=>{t.value=(await n.rws.getFreeAuctions()).length}));const o=await n.rws.getMinimalBid();e.value=o.add((0,Q.G)(1))})(),(0,s.Ah)((()=>{a&&a(),d&&d(),u()}));const v=X(),f=async()=>{const a=o.value;if(o.value="processing",r.value="",!c.value||(0,Q.G)(c.value).add((0,Q.G)(1e9)).lt(e.value))return o.value="error",void(r.value="Subscription can not be activated due to unsuffcicient XRT balance");if(t.value<=0)return o.value="error",void(r.value="There are no available subscriptions");if(p.hasSubscription.value&&p.isActive.value)return o.value="error",void(r.value="You have an active subscription");let l=n.rws.bid(Number(await n.rws.getFirtsFreeAuction()),e.value);m.devices.value.includes(i.value)||(l=n.api.tx.utility.batch([l,n.rws.setDevices([...m.devices.value,i.value])]));const u=v.createTx();if(await v.send(u,l),u.error.value)return void("Cancelled"!==u.error.value?(o.value="error",r.value=u.error.value):o.value=a);const d=await n.events.onBlock((()=>{p.loadLedger()})),w=(0,s.m0)((()=>{p.hasSubscription.value&&p.isActive.value&&(w(),d(),o.value="ok")}))},h=(0,s.Fl)((()=>w(e.value,n.api.registry.chainDecimals[0])));return{freeAuctions:t,price:h,status:o,message:r,onActivate:f}}};const te=(0,h.Z)(ee,[["render",B]]);var oe=te;function re(e,t,o,r,a,n){const i=(0,s.up)("robo-template-rws-setup"),l=(0,s.up)("robo-layout-section");return(0,s.wg)(),(0,s.j4)(l,{rwsrecover:""},{default:(0,s.w5)((()=>[(0,s.Wm)(i,{owner:r.ownerNew,"onUpdate:owner":t[0]||(t[0]=e=>r.ownerNew=e),controller:r.controllerNew,"onUpdate:controller":t[1]||(t[1]=e=>r.controllerNew=e),scontroller:r.scontrollerNew,"onUpdate:scontroller":t[2]||(t[2]=e=>r.scontrollerNew=e),name:r.nameNew,"onUpdate:name":t[3]||(t[3]=e=>r.nameNew=e),enddate:r.enddateNew,"onUpdate:enddate":t[4]||(t[4]=e=>r.enddateNew=e),onOnRwsSetup:r.onSetup},null,8,["owner","controller","scontroller","name","enddate","onOnRwsSetup"])])),_:1})}var ae={setup(){const e=(0,l.iH)(null),t=(0,l.iH)(null),o=(0,l.iH)(null),r=(0,l.iH)(null),a=K(e),n=e=>{e("ok")};return{ownerNew:e,controllerNew:t,scontrollerNew:o,nameNew:r,enddateNew:a.validUntil,onSetup:n}}};const ne=(0,h.Z)(ae,[["render",re]]);var se=ne;function ie(e,t,o,r,a,n){const i=(0,s.up)("robo-template-rws-setups-empty"),l=(0,s.up)("robo-section"),u=(0,s.up)("robo-layout-section"),c=(0,s.up)("robo-template-rws-setup-listitem"),d=(0,s.up)("robo-grid"),p=(0,s.up)("robo-button");return r.rws?.length<1?((0,s.wg)(),(0,s.j4)(u,{key:0,rwsrecover:""},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{width:"narrow",gcenter:""},{default:(0,s.w5)((()=>[(0,s.Wm)(i)])),_:1})])),_:1})):((0,s.wg)(),(0,s.j4)(u,{key:1,rwsrecover:"",rwssave:""},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{offset:"x0",width:"narrow"},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{offset:"x1",gap:"x1"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(r.rws,((e,t)=>((0,s.wg)(),(0,s.j4)(c,{key:t,owner:e.owner,"onUpdate:owner":t=>e.owner=t,controller:e.controller,"onUpdate:controller":t=>e.controller=t,scontroller:e.scontroller,"onUpdate:scontroller":t=>e.scontroller=t,name:e.name,"onUpdate:name":t=>e.name=t,enddate:e.enddate,"onUpdate:enddate":t=>e.enddate=t,onEdit:r.onEdit,onOnRwsDelete:r.onDelete},null,8,["owner","onUpdate:owner","controller","onUpdate:controller","scontroller","onUpdate:scontroller","name","onUpdate:name","enddate","onUpdate:enddate","onEdit","onOnRwsDelete"])))),128))])),_:1}),(0,s.Wm)(p,{block:"",router:r.store.state.robonomicsUIvue.rws.links.setup},{default:(0,s.w5)((()=>[(0,s.Uk)(" + Add new rws ")])),_:1},8,["router"])])),_:1})])),_:1}))}var le={setup(){const e=(0,D.oR)(),t=(0,s.Fl)((()=>e.state.robonomicsUIvue.rws.list));let o=e=>{e("ok")},r=e=>{e("ok")};return{store:e,rws:t,onEdit:o,onDelete:r}}};const ue=(0,h.Z)(le,[["render",ie]]);var ce=ue;function de(e,t,o,r,a,n){const i=(0,s.up)("robo-template-rws-user-setup"),l=(0,s.up)("robo-layout-section");return(0,s.wg)(),(0,s.j4)(l,{rwsrecover:""},{default:(0,s.w5)((()=>[(0,s.Wm)(i,{address:r.addressNew,"onUpdate:address":t[0]||(t[0]=e=>r.addressNew=e),name:r.nameNew,"onUpdate:name":t[1]||(t[1]=e=>r.nameNew=e),onOnUserSetup:r.onSetup},null,8,["address","name","onOnUserSetup"])])),_:1})}var pe={setup(){let e=(0,l.iH)(null),t=(0,l.iH)(null);const o=(0,D.oR)();let r=(0,l.iH)(o.state.robonomicsUIvue.rws.active);(0,s.YP)((()=>o.state.robonomicsUIvue.rws.active),(()=>{r.value=o.state.robonomicsUIvue.rws.active}));const a=q(),n=X(),i=G(r),u=async t=>{if(r.value&&r.value!==o.state.robonomicsUIvue.polkadot.address)t("error","You do not have access to this action.");else{if(!i.devices.value.includes(e.value)){const s=await a.rws.setDevices([...i.devices.value,e.value]),l=n.createTx();if(i.devices.value.includes(o.state.robonomicsUIvue.polkadot.address)?await n.send(l,s,r.value):await n.send(l,s),l.error.value)return void("Cancelled"!==l.error.value?t("error",l.error.value):t("calcel"))}t("ok")}};return{addressNew:e,nameNew:t,onSetup:u}}};const me=(0,h.Z)(pe,[["render",de]]);var we=me,ve={__name:"RwsUsersList",setup(e){const t=(0,D.oR)(),o=(0,s.Fl)((()=>t.state.robonomicsUIvue.rws.list)),r=(0,s.Fl)((()=>t.state.robonomicsUIvue.rws.active)),a=(0,s.Fl)((()=>{try{return t.getters["rws/users"]}catch(e){return[]}})),n=e=>{e("ok")},i=q(),u=X(),c=G(r),d=async(e,o)=>{if(r.value&&r.value!==t.state.robonomicsUIvue.polkadot.address)o("error","You do not have access to this action.");else{if(c.devices.value.includes(e)){const a=c.devices.value.filter((t=>t!==e)),n=await i.rws.setDevices(a),s=u.createTx();if(c.devices.value.includes(t.state.robonomicsUIvue.polkadot.address)?await u.send(s,n,r.value):await u.send(s,n),s.error.value)return void("Cancelled"!==s.error.value?o("error",s.error.value):o("calcel"));await c.loadDevices()}o("ok")}},p=()=>{for(const e of c.devices.value)a.value.find((t=>t.address===e))||t.dispatch("rws/addUser",{rws:c.owner.value,user:{address:e,name:e===c.owner.value?"owner":""}});for(const e of a.value)c.devices.value.find((t=>e.address===t))||t.dispatch("rws/deleteUser",{rws:c.owner.value,user:e.address})};return(0,s.YP)(c.devices,p),(e,i)=>{const u=(0,s.up)("robo-template-rws-users-empty"),c=(0,s.up)("robo-section"),p=(0,s.up)("robo-layout-section"),m=(0,s.up)("robo-template-rws-user-listitem"),w=(0,s.up)("robo-grid"),v=(0,s.up)("robo-button");return o.value?.length<1||!a.value||a.value.length<1?((0,s.wg)(),(0,s.j4)(p,{key:0},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{width:"narrow",gcenter:""},{default:(0,s.w5)((()=>[(0,s.Wm)(u)])),_:1})])),_:1})):((0,s.wg)(),(0,s.j4)(p,{key:1,rwssave:""},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{offset:"x0",width:"narrow"},{default:(0,s.w5)((()=>[(0,s.Wm)(w,{offset:"x1",gap:"x1"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.value,((e,t)=>((0,s.wg)(),(0,s.j4)(m,{key:t,owner:r.value,address:e.address,"onUpdate:address":t=>e.address=t,name:e.name,"onUpdate:name":t=>e.name=t,onEdit:n,onOnUserDelete:t=>d(e.address,t)},null,8,["owner","address","onUpdate:address","name","onUpdate:name","onOnUserDelete"])))),128))])),_:1}),(0,s.Wm)(v,{block:"",router:(0,l.SU)(t).state.robonomicsUIvue.rws.links.useractivate},{default:(0,s.w5)((()=>[(0,s.Uk)(" + Add user ")])),_:1},8,["router"])])),_:1})])),_:1}))}}};const fe=ve;var he=fe;function ge(e,t){const o=(0,s.up)("robo-image"),r=(0,s.up)("robo-link"),a=(0,s.up)("robo-text"),n=(0,s.up)("robo-card"),i=(0,s.up)("robo-grid"),l=(0,s.up)("robo-layout-section");return(0,s.wg)(),(0,s.j4)(l,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{offset:"x0",gap:"x1",galign:"start",minColumnWidth:"450px"},{default:(0,s.w5)((()=>[(0,s.Wm)(n,null,{default:(0,s.w5)((()=>[(0,s.Wm)(r,{router:"/telemetry"},{default:(0,s.w5)((()=>[(0,s.Wm)(o,{src:"images/services-ha.jpg"})])),_:1}),(0,s.Wm)(a,{title:"3"},{default:(0,s.w5)((()=>[(0,s.Wm)(r,{router:"/telemetry"},{default:(0,s.w5)((()=>[(0,s.Uk)("Home assistant")])),_:1})])),_:1}),(0,s.Wm)(a,{size:"small"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Integrate Robonomics into your Home assistant dashboard and get Parachain decentralized cloud service all over the word. Manipulate your smart devices bypassing corporate clouds, manage user access wherever you are. Backup your smart home data in blockchain. ")])),_:1})])),_:1}),(0,s.Wm)(n,null,{default:(0,s.w5)((()=>[(0,s.Wm)(r,{href:"https://sensors.robonomics.network/#/"},{default:(0,s.w5)((()=>[(0,s.Wm)(o,{src:"images/services-sensors.jpg"})])),_:1}),(0,s.Wm)(a,{title:"3"},{default:(0,s.w5)((()=>[(0,s.Wm)(r,{href:"https://sensors.robonomics.network/#/"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Sensors Map ")])),_:1})])),_:1}),(0,s.Wm)(a,{size:"small"},{default:(0,s.w5)((()=>[(0,s.Uk)(" The decentralized opensource sensors map offers two distinct layers of decentralization at your choise: peer-to-peer connectivity for direct access to sensor data, and the federative concept for accumulating sensor data and displaying measurement history. Anyone can assemble your own sensor using components available on the free market. ")])),_:1})])),_:1}),(0,s.Wm)(n,null,{default:(0,s.w5)((()=>[(0,s.Wm)(r,{href:"https://dapp.spot-sdk.education"},{default:(0,s.w5)((()=>[(0,s.Wm)(o,{src:"images/services-spot.jpg"})])),_:1}),(0,s.Wm)(a,{title:"3"},{default:(0,s.w5)((()=>[(0,s.Wm)(r,{href:"https://dapp.spot-sdk.education"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Boston Dynamics Spot SDK lessons ")])),_:1})])),_:1}),(0,s.Wm)(a,{size:"small"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Learn and practice with the Boston Dynamics Spot robot wherever you are. After each lesson you will receive a captured video of the robot movements and a printable PDF certificate. ")])),_:1})])),_:1}),(0,s.Wm)(n,null,{default:(0,s.w5)((()=>[(0,s.Wm)(r,{href:"https://telescope.merklebot.com/#/"},{default:(0,s.w5)((()=>[(0,s.Wm)(o,{src:"images/services-telescope.jpg"})])),_:1}),(0,s.Wm)(a,{title:"3"},{default:(0,s.w5)((()=>[(0,s.Wm)(r,{href:"https://telescope.merklebot.com/#/"},{default:(0,s.w5)((()=>[(0,s.Uk)(" An Autonomous Telescope Minting RMRK NFT's ")])),_:1})])),_:1}),(0,s.Wm)(a,{size:"small"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Connect to an autonomous telescope in the dark night of the Atacama desert in Chile to capture an astronomical object and mint unique NFTs in a few clicks. ")])),_:1})])),_:1}),(0,s.Wm)(n,null,{default:(0,s.w5)((()=>[(0,s.Wm)(r,{href:"https://dapp.ipci.io/#/offsetting"},{default:(0,s.w5)((()=>[(0,s.Wm)(o,{src:"images/services-offsetting.jpg"})])),_:1}),(0,s.Wm)(a,{title:"3"},{default:(0,s.w5)((()=>[(0,s.Wm)(r,{href:"https://dapp.ipci.io/#/offsetting"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Smart Building Offsetting ")])),_:1})])),_:1}),(0,s.Wm)(a,{size:"small"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Carbon footprint clearance for smart buildings based on geolocation and energy consumption information. ")])),_:1})])),_:1})])),_:1})])),_:1})}const be={},ye=(0,h.Z)(be,[["render",ge]]);var ke=ye;const Ue=(0,s._)("p",null,"To open your local Home Assistant panel:",-1),_e=(0,s._)("p",null," 1. Please enter in browser the following url: http://YOUR_LOCAL_IP:8123 ",-1),We=(0,s._)("p",null,"2. Login: enter your user address",-1),Se=(0,s._)("p",null,"3. Password: enter password you created here",-1);function xe(e,t,o,r,a,n){const i=(0,s.up)("robo-link"),l=(0,s.up)("robo-text"),u=(0,s.up)("robo-section"),c=(0,s.up)("form-check"),d=(0,s.up)("form-create"),p=(0,s.up)("robo-layout-section");return(0,s.wg)(),(0,s.j4)(p,null,{default:(0,s.w5)((()=>[(0,s.Wm)(u,{mark:"info",offset:"x0",width:"narrow"},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{offset:"x0"},{default:(0,s.w5)((()=>[(0,s.Uk)(" You can create a password here to access your local Home Assistant account, if you already have an RWS subscription or have been added as a user to an RWS subscription. "),(0,s.Wm)(i,{href:"https://wiki.robonomics.network/docs/global-administration#granting-access-to-user"},{default:(0,s.w5)((()=>[(0,s.Uk)(" More on Wiki ")])),_:1})])),_:1})])),_:1}),(0,s.Wm)(u,{width:"narrow"},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{onCheck:r.handleCheck},null,8,["onCheck"]),(0,s.Wm)(d,{"isCheсk":r.isCheсk,ownerAddress:r.ownerAddress,controllerAddress:r.controllerAddress,userSeed:r.userSeed},null,8,["isCheсk","ownerAddress","controllerAddress","userSeed"])])),_:1}),(0,s.Wm)(u,{mark:"info",marktitle:"What's next",offset:"x0",width:"narrow"},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{offset:"x0"},{default:(0,s.w5)((()=>[Ue,_e,We,Se])),_:1})])),_:1})])),_:1})}function Ae(e,t,o,r,a,i){const l=(0,s.up)("robo-text"),u=(0,s.up)("robo-grid-item"),c=(0,s.up)("robo-template-rws-activeselect"),d=(0,s.up)("robo-address-polkadot"),p=(0,s.up)("robo-input"),m=(0,s.up)("robo-button"),w=(0,s.up)("robo-grid");return(0,s.wg)(),(0,s.iD)("form",{onSubmit:t[3]||(t[3]=(0,n.iM)(((...e)=>r.validate&&r.validate(...e)),["prevent"]))},[(0,s.Wm)(w,{offset:"x0",gap:"x1",columns:"1"},{default:(0,s.w5)((()=>[(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(l,{title:"3",offset:"x0"},{default:(0,s.w5)((()=>[(0,s.Uk)("User credits")])),_:1})])),_:1}),(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,{size:"small",block:"",label:"Choose RWS"})])),_:1}),r.hasRwsSetup?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(u,{key:0},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{address:r.controllerAddress,"onUpdate:address":t[0]||(t[0]=e=>r.controllerAddress=e),chain:"32",label:"Controller address"},null,8,["address"])])),_:1})),(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,{address:r.address,"onUpdate:address":t[1]||(t[1]=e=>r.address=e),chain:"32",label:"User address"},null,8,["address"])])),_:1}),(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(p,{label:"User seed (12 words)",modelValue:r.seed,"onUpdate:modelValue":t[2]||(t[2]=e=>r.seed=e),type:"password",tip:"The seed phrase provided here is essential for encrypting your data. We understand the sensitivity of this information and therefore, do not share it with any third parties or store it on our servers. As an extra layer of security, we recommend avoiding storing a large number of tokens in this account to reduce the risk of potential unauthorized access."},null,8,["modelValue"])])),_:1}),(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(m,{block:""},{default:(0,s.w5)((()=>[(0,s.Uk)("Check")])),_:1})])),_:1}),r.warn?((0,s.wg)(),(0,s.j4)(u,{key:1},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{highlight:"attention"},{default:(0,s.w5)((()=>["user-exist"===r.warn?((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[(0,s.Uk)(" Warn! The specified account address is already registered. ")],64)):(0,s.kq)("",!0)])),_:1})])),_:1})):(0,s.kq)("",!0),r.error?((0,s.wg)(),(0,s.j4)(u,{key:2},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{highlight:"error"},{default:(0,s.w5)((()=>["require"===r.error?((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[(0,s.Uk)(" Oops! Looks like you missed filling in some required fields. Please fill in all required fields and try again. ")],64)):(0,s.kq)("",!0),"not-user-subscription"===r.error?((0,s.wg)(),(0,s.iD)(s.HY,{key:1},[(0,s.Uk)(" Oops! It seems like your address has not been added to the RWS subscription. ")],64)):(0,s.kq)("",!0),"bad-type"===r.error?((0,s.wg)(),(0,s.iD)(s.HY,{key:2},[(0,s.Uk)(" Oops! Address should be ed25519 type ")],64)):(0,s.kq)("",!0),"bad-seed"===r.error?((0,s.wg)(),(0,s.iD)(s.HY,{key:3},[(0,s.Uk)(" Oops! Seed does not match user address. ")],64)):(0,s.kq)("",!0)])),_:1})])),_:1})):(0,s.kq)("",!0)])),_:1})],32)}function He(){const{account:e}=Z(),{instance:t}=(0,s.f3)("IpfsProvider");return(0,s.YP)(e,(async()=>{t.value&&t.value.authClear()})),t.value}var Ie=o(89361),Re=o(86251);const Ne=e=>e.replaceAll("'",'"').replaceAll("\\","").replaceAll('""','"').replaceAll("True","true").replaceAll("False","false").replaceAll("None",'"None"'),Oe=e=>{try{return JSON.parse(e)}catch(t){console.log("error parse 1")}try{return JSON.parse(Ne(e))}catch(t){console.log("error parse 2"),console.log(e)}return!1},Ce=(e,t,o)=>{const r=o.decryptMessage((0,Ie.G)(e),t);return(0,Re.z)(r)},je=async(e,t)=>{if(console.log("getLastDatalog"),!t)return!1;const o=await e.datalog.read(t);if(!o.length)return!1;const r=o[o.length-1];return{timestamp:r[0].toNumber(),cid:(0,Re.z)(r[1])}},$e=async(e,t,o)=>{if(console.log("getConfigCid"),!t||!o)return!1;const r=await e.twin.getTwin(o);if(!r)return!1;const a=Object.keys(r).find((e=>r[e]===t));return O.P6.hexToCid(a)};var Pe=o(5470),Me=o(19330),De={emits:["check"],setup(e,{emit:t}){const o=(0,l.iH)(""),r=(0,l.iH)(""),a=(0,l.iH)(!1),n=(0,l.iH)(!1),i=(0,l.iH)(!1),u=(0,l.iH)(""),c=q(),d=He();let p;const m=(0,D.oR)();(0,s.YP)((()=>m.state.robonomicsUIvue.rws.active),(async()=>{const e=m.state.robonomicsUIvue.rws.list.find((e=>e.owner===m.state.robonomicsUIvue.rws.active));e?(p=e.owner,u.value=e.controller):p=m.state.robonomicsUIvue.rws.active}),{immediate:!0}),(0,s.YP)((()=>m.state.robonomicsUIvue.rws.list),(async()=>{i.value=!!m.state.robonomicsUIvue.rws.list.length}),{immediate:!0});const w=()=>!!(r.value&&o.value&&u.value),v=async(t,o)=>{try{(0,J.Y)(t),(0,J.Y)(o)}catch(e){return!1}const r=await c.rws.getDevices(t);return!(r.isEmpty||!r.toHuman().includes(o))},f=(e="ed25519")=>{try{const t=new Pe.Y,a=t.addFromUri(r.value,{},e);if((0,Me.m)(o.value)===(0,Me.m)(a.address))return!0}catch(a){console.log(a)}return!1},h=async()=>{if(a.value=!1,n.value=!1,w())if(f("sr25519"))a.value="bad-type";else if(await v(p,o.value))if(f()){const e=await je(c,u.value),t=await d.catViaGateway(m.state.robonomicsUIvue.ipfs.activegateway,e.cid,5);t&&t[o.value]?n.value="user-exist":t||console.log("Error: datalog not found in ipfs")}else a.value="bad-seed";else a.value="not-user-subscription";else a.value="require";a.value?t("check",{"isCheсk":!1,ownerAddress:"",controllerAddress:"",userSeed:""}):t("check",{"isCheсk":!0,ownerAddress:p,controllerAddress:u.value,userSeed:r.value})};return{hasRwsSetup:i,controllerAddress:u,address:o,seed:r,error:a,warn:n,validate:h}}};const Ye=(0,h.Z)(De,[["render",Ae]]);var Fe=Ye,Te=o(87139);function Le(e,t,o,r,a,i){const l=(0,s.up)("robo-text"),u=(0,s.up)("robo-grid-item"),c=(0,s.up)("robo-input"),d=(0,s.up)("robo-button"),p=(0,s.up)("robo-grid");return(0,s.wg)(),(0,s.iD)("form",{onSubmit:t[2]||(t[2]=(0,n.iM)(((...e)=>r.createPassword&&r.createPassword(...e)),["prevent"]))},[(0,s.Wm)(p,{offset:"x1",gap:"x1",columns:"1",disabled:!o.isCheсk},{default:(0,s.w5)((()=>[(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(l,{title:"3",offset:"x0"},{default:(0,s.w5)((()=>[(0,s.Uk)("New password")])),_:1})])),_:1}),(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,{label:"New password",modelValue:r.password,"onUpdate:modelValue":t[0]||(t[0]=e=>r.password=e),type:"password"},null,8,["modelValue"])])),_:1}),(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,{label:"Repeat password",modelValue:r.passwordRepeat,"onUpdate:modelValue":t[1]||(t[1]=e=>r.passwordRepeat=e),type:"password"},null,8,["modelValue"])])),_:1}),(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,{block:"",disabled:r.isDisabled},{default:(0,s.w5)((()=>[(0,s.Uk)("Submit")])),_:1},8,["disabled"])])),_:1}),r.error?((0,s.wg)(),(0,s.j4)(u,{key:0},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{highlight:"error"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,Te.zw)(r.error),1)])),_:1})])),_:1})):(0,s.kq)("",!0)])),_:1},8,["disabled"])],32)}var Ee=o(2629),ze={props:{"isCheсk":Boolean,ownerAddress:String,controllerAddress:String,userSeed:String},setup(e){const{"isCheсk":t,ownerAddress:o,controllerAddress:r,userSeed:a}=(0,l.BK)(e),n=(0,l.iH)(""),i=(0,l.iH)(""),u=(0,l.iH)(""),c=q(),d=X(),p=(0,D.oR)(),m=d.createTx();let w;(0,s.YP)(a,(()=>{if(t.value)try{const e=new Pe.Y({ss58Format:c.api?.registry.chainSS58});return void(w=e.addFromUri(a.value,{},"ed25519"))}catch(u){console.log(u)}w=null}),{immediate:!0});const v=(e,t)=>{const o=w.encryptMessage(e,(0,C.c)((0,Ee.m)(t)));return(0,C.c)(o)};let f,h;(0,s.m0)((()=>{t.value&&g.value&&b.value?(f=v(n.value,w.address),h=v(n.value,r.value)):(f="",h=""),console.log({passwordForRecovery:f,passwordForAdmin:h})}));const g=(0,s.Fl)((()=>!(!n.value||!i.value))),b=(0,s.Fl)((()=>n.value===i.value)),y=(0,s.Fl)((()=>m.process.value?(console.log("process"),!0):t.value?g.value?b.value?(!h||!f)&&(console.log("passwordForAdmin passwordForRecovery"),!0):(console.log("checkPasswordsMatch"),!0):(console.log("validateRequire"),!0):(console.log("isCheсk"),!0))),k=async()=>{if(!t.value)return;c.accountManager.account=w;const e=await c.datalog.write(JSON.stringify({subscription:o.value,ha:r.value,admin:h,user:f}));await d.send(m,e,o.value),m.error.value&&("Cancelled"!==m.error.value?u.value=m.error.value:console.log("calcel"));const a=p.state.robonomicsUIvue.polkadot.accounts.find((e=>e.address===p.state.robonomicsUIvue.polkadot.address));await c.accountManager.setSender(a.address,{type:a.type,extension:p.state.robonomicsUIvue.polkadot.extensionObj})};return{password:n,passwordRepeat:i,error:u,isDisabled:y,createPassword:k}}};const Be=(0,h.Z)(ze,[["render",Le]]);var qe=Be,Ze={components:{FormCheck:Fe,FormCreate:qe},setup(){const e=(0,l.iH)(!1),t=(0,l.iH)(""),o=(0,l.iH)(""),r=(0,l.iH)(""),a=a=>{e.value=a.isCheсk,t.value=a.ownerAddress,o.value=a.controllerAddress,r.value=a.userSeed};return{"isCheсk":e,ownerAddress:t,controllerAddress:o,userSeed:r,handleCheck:a}}};const Ve=(0,h.Z)(Ze,[["render",xe]]);var Je=Ve;const Ge={style:{"text-align":"right"}};function Ke(e,t,o,r,a,n){const i=(0,s.up)("robo-button"),l=(0,s.up)("Libp2p"),u=(0,s.up)("Launch"),c=(0,s.up)("robo-loader"),d=(0,s.up)("robo-layout-section");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",Ge,[(0,s.Wm)(i,{onClick:t[0]||(t[0]=e=>r.type="libp2p"),disabled:"libp2p"===r.type,size:"small"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Libp2p ")])),_:1},8,["disabled"]),(0,s.Wm)(i,{onClick:t[1]||(t[1]=e=>r.type="launch"),disabled:"launch"===r.type,size:"small"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Parachain ")])),_:1},8,["disabled"])]),r.config?((0,s.wg)(),(0,s.iD)(s.HY,{key:0},["libp2p"===r.type?((0,s.wg)(),(0,s.j4)(l,{key:0,config:r.config,onError:r.error},null,8,["config","onError"])):((0,s.wg)(),(0,s.j4)(u,{key:1,config:r.config},null,8,["config"]))],64)):((0,s.wg)(),(0,s.j4)(d,{key:1},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{gcenter:""},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{size:"2"})])),_:1})])),_:1}))],64)}function Xe(e,t,o,r,a,n){const i=(0,s.up)("robo-template-devices-layout");return(0,s.wg)(),(0,s.j4)(i,{config:o.config,datalog:r.data,updateTime:r.updateTime},null,8,["config","datalog","updateTime"])}var Qe=o(22273);const et=32,tt=async(e,t,o)=>{if(!o)return!1;try{return await t.catViaGateway(e.state.robonomicsUIvue.ipfs.activegateway,o,2)}catch(r){try{const r=await t.catViaGateways(e.state.robonomicsUIvue.ipfs.gateways,o);return e.commit("ipfs/setActiveGateway",r.gateway),r.result}catch(a){console.log(a.message)}}return!1},ot=async(e,t,o)=>{if(e)try{const r=Ce(e[t.address],t.publicKey,t),a=o.addFromUri(r,{},"ed25519"),n=Ce(e.data,t.publicKey,a);return Oe(n)}catch(r){console.log(r.message)}return!1},rt=async(e,t,o,r,a)=>{if(e){const n=await tt(o,r,e);if(!n)return console.log(`Error: ${e} not found in ipfs`),null;const s=await ot(n,t,a);if(s)return s;console.log("Error: decryptMsg")}return null},at=(e,t)=>{if(!e.state.robonomicsUIvue.rws.active)return;const o=e.state.robonomicsUIvue.rws.list.find((t=>t.owner===e.state.robonomicsUIvue.rws.active));if(o)try{return{controller:t.addFromUri(o.scontroller,{},"ed25519"),owner:o.owner}}catch(r){console.log(r)}return{controller:null,owner:null}},nt=()=>{const e=(0,l.iH)(null),t=(0,l.iH)(null),o=(0,D.oR)(),r=new Pe.Y({ss58Format:et});return(0,s.YP)((()=>o.state.robonomicsUIvue.rws.active),(()=>{const a=at(o,r);e.value=a.controller,t.value=a.owner}),{immediate:!0}),{controller:e,owner:t}},st=(e,t,o=3e3)=>{e.dispatch("app/setStatus",{value:t,timeout:o}),console.log(t)},it=(e,t,o)=>{e.commit("rws/setLaunch",JSON.stringify({...t,tx:{tx_status:o}}))},lt=()=>{const e=(0,l.iH)(null),t=(0,l.iH)(null),o=(0,D.oR)(),r=He(),a=q(),{controller:n}=nt(),s=new Pe.Y({ss58Format:et});return(async()=>{st(o,"Find twin id");const i=await je(a,n.value.address),l=await rt(i.cid,n.value,o,r,s);if(l){const i=l.twin_id;st(o,`Twin id #${i}`),st(o,"Start load config"),e.value=await $e(a,n.value.address,i),t.value=await rt(e.value,n.value,o,r,s),st(o,"Config loaded")}else st(o,"Error: not found twin id")})(),{config:t,cid:e}},ut=()=>{const e=(0,l.iH)(null),t=(0,l.iH)(null),o=(0,l.iH)(null),r=(0,D.oR)(),a=He(),n=q(),i=X(),u=G(),{controller:c,owner:d}=nt();(0,s.YP)((()=>r.state.robonomicsUIvue.rws.active),(()=>{u.owner.value=r.state.robonomicsUIvue.rws.active}),{immediate:!0});const p=new Pe.Y({ss58Format:et});let m;const w=async()=>{m=await n.datalog.on({method:"NewRecord"},(o=>{const r=o.filter((e=>e.success&&e.data[0].toHuman()===c.value.address));for(const a of r)t.value=a.data[1].toNumber(),e.value=a.data[2].toHuman()}))};(0,s.YP)(e,(async()=>{o.value=await rt(e.value,c.value,r,a,p)}));const v=async()=>{const o=await je(n,c.value.address);e.value=o.cid,t.value=o.updateTime,w()},f=()=>{m&&m()};(0,s.Ah)((()=>{console.log("unmount launch"),f()}));const h=async e=>{if(console.log(e.launch.params.entity_id,e.tx.tx_status),"pending"!==e.tx.tx_status)return;if(st(r,"Launch command"),console.log(`command ${JSON.stringify(e)}`),n.accountManager.account.address!==r.state.robonomicsUIvue.rws.active&&!u.devices.value.includes(n.accountManager.account.address))return st(r,"Error: You do not have access to device management."),void it(r,e,"error");if(!a.isAuth()){st(r,"Authorization on ipfs node");try{const e=(await n.accountManager.account.signMsg((0,Qe.d)(n.accountManager.account.address))).toString();a.auth(d.value,n.accountManager.account.address,e)}catch(l){return void("Cancelled"===l.message?it(r,e,"declined"):(console.log(l),it(r,e,"error")))}it(r,e,"approved")}let t;try{t=await a.add(JSON.stringify(e.launch))}catch(l){return it(r,e,"error"),void st(r,`Error: ${l.message}`)}console.log(`launch ipfs file ${t.path}`),st(r,"Send launch");const o=n.launch.send(c.value.address,t.path),s=i.createTx();await i.send(s,o,d.value),s.error.value?"Cancelled"!==s.error.value?(it(r,e,"error"),st(r,`Error: ${s.error.value}`)):(it(r,e,"declined"),st(r,"Calcel")):(console.log(e),it(r,e,"success"),st(r,"Launch sended"))};return{cid:e,updateTime:t,data:o,run:v,stop:f,launch:h}};var ct={props:{config:Object},setup(){const{data:e,updateTime:t,run:o,launch:r}=ut(),a=(0,D.oR)();return o(),(0,s.YP)((()=>a.state.robonomicsUIvue.rws.launch),(e=>{try{r(JSON.parse(e))}catch(t){console.log(t)}})),{data:e,updateTime:t}}};const dt=(0,h.Z)(ct,[["render",Xe]]);var pt=dt;function mt(e,t,o,r,a,n){const i=(0,s.up)("robo-template-devices-layout");return(0,s.wg)(),(0,s.j4)(i,{config:o.config,datalog:r.data,updateTime:r.updateTime},null,8,["config","datalog","updateTime"])}var wt=o(73057),vt=o(93446),ft=o(4073),ht=o(84698),gt=o(29484),bt=o(20573),yt=o(23086),kt=o(26723),Ut=o(44455),_t=o(19174),Wt=o(82543),St=o(7010);function xt(){return e=>{async function t(e){return(0,_t.z)(e,(async function(e){let t="";for await(const o of e)t+=(0,St.B)(o.subarray());return JSON.parse(t)}))}async function o(e,t){return(0,_t.z)([(0,Wt.m)(JSON.stringify(t))],e.sink).finally((()=>{e.close()}))}return{async handle(o,r,a={runOnTransientConnection:!0}){await e.registrar.handle(o,(async({stream:e})=>{r(await t(e),e)}),a)},async request(e,t,o,r={runOnTransientConnection:!0}){if("open"!==e.status)return;const a=await e.newStream([t],r);return(0,_t.z)([(0,Wt.m)(JSON.stringify(o))],a,(async function(e){let t="";for await(const r of e)t+=(0,St.B)(r.subarray());try{return JSON.parse(t)}catch(o){return t}}))},utils:{getRequest:t,sendResponse:o}}}}async function At(){const e=await(0,yt.N)({addresses:{listen:["/webrtc"]},transports:[(0,ht.E)({filter:gt.$6}),(0,ft.Z)(),(0,kt.f)()],streamMuxers:[(0,vt.R)()],connectionEncryption:[(0,wt.t)()],services:{identify:(0,Ut.HA)(),ha:xt()},connectionGater:{denyDialMultiaddr:()=>!1},connectionManager:{minConnections:0}});return e}let Ht=null,It=[],Rt=null;async function Nt(){if(!Ht)return Ht=await At(),await Ht.start(),console.log(`Node started with id ${Ht.peerId.toString()}`),Ht.addEventListener("connection:open",(t=>{console.log("connected",t.detail.remoteAddr.toString()),e()})),Ht.addEventListener("connection:close",(t=>{console.log("disconected",t.detail.remoteAddr.toString()),e(),t.detail.remoteAddr.toString()===Rt.remoteAddr.toString()&&Ot(Rt.remoteAddr.toString())})),Ht;function e(){It=Ht.getConnections().map((e=>e.remoteAddr.toString())),console.log("Update Connections List",It)}}async function Ot(e){try{await Ct(e)}catch(t){console.log(t),setTimeout((async()=>{e&&!It.includes(e)&&await Ot(e)}),3e3)}}async function Ct(e){const t=(0,bt.HM)(e);Rt=await Ht.dial(t)}function jt(e){if(Ht&&Rt)return Ht.services.ha.request(Rt,"/call",e);throw new Error("error")}const $t=()=>{const e=(0,l.iH)(null),t=(0,D.oR)(),o=q(),r=G(),{controller:a}=nt();(0,s.YP)((()=>t.state.robonomicsUIvue.rws.active),(()=>{r.owner.value=t.state.robonomicsUIvue.rws.active}),{immediate:!0});const n=new Pe.Y({ss58Format:et}),i=async o=>{const r=await Nt();try{return st(t,`Connect to peer id ${o}`),await Ct(`/dns4/libp2p-relay.robonomics.network/tcp/443/wss/p2p/12D3KooWEmZfGh3HEy7rQPKZ8DpJRYfFcbULN97t3hGwkB5xPmjn/p2p-circuit/p2p/${o}`),st(t,"Connected"),r.services.ha.handle("/update",(async(o,s)=>{const i=await ot(JSON.parse(o),a.value,n);i?(e.value=i,await r.services.ha.utils.sendResponse(s,{result:!0})):st(t,"Error: decryptMsg")})),!0}catch(s){st(t,`Error: ${s.message}`),console.log(s)}return!1},u=async e=>{if(console.log(e.launch.params.entity_id,e.tx.tx_status),"pending"!==e.tx.tx_status)return;if(st(t,"Launch command"),console.log(`command ${JSON.stringify(e)}`),o.accountManager.account.address!==t.state.robonomicsUIvue.rws.active&&!r.devices.value.includes(o.accountManager.account.address))return st(t,"Error: You do not have access to device management."),void it(t,e,"error");const a=await jt(e.launch);console.log(`response: ${a}`),it(t,e,"success")};return{data:e,run:i,launch:u}};var Pt={props:{config:Object},emits:["error"],setup(e,{emit:t}){const o="",{data:r,run:a,launch:n}=$t();e.config.peer_id?(async()=>{const o=await a(e.config.peer_id);o||t("error")})():(console.log("Error: not peer_id"),console.log(e.config));const i=(0,D.oR)();return(0,s.YP)((()=>i.state.robonomicsUIvue.rws.launch),(e=>{try{n(JSON.parse(e))}catch(t){console.log(t)}})),{data:r,updateTime:o}}};const Mt=(0,h.Z)(Pt,[["render",mt]]);var Dt=Mt,Yt={setup(){const e=(0,l.iH)("libp2p"),{config:t}=lt();return(0,s.YP)([t,e],(()=>{t.value&&!t.value.peer_id&&"libp2p"===e.value&&(console.log("Error: not peer_id"),console.log(t.value),e.value="launch")})),{type:e,config:t,error:()=>{e.value="launch"}}},components:{Libp2p:Dt,Launch:pt}};const Ft=(0,h.Z)(Yt,[["render",Ke]]);var Tt=Ft;const Lt=[{path:"/",name:"Home",component:T,meta:{title:"Dashboard"}},{path:"/rws-activate",name:"rwsActivate",component:oe,meta:{title:"RWS activation"}},{path:"/rws-setup",name:"rwsSetup",component:se,meta:{title:"RWS setup"}},{path:"/rws-setups-list",name:"rwsSetupsList",component:ce,meta:{title:"Your RWS setups"}},{path:"/rws-user-setup",name:"rwsUserSetup",component:we,meta:{title:"RWS add user"}},{path:"/rws-users-list",name:"rwsUsersList",component:he,meta:{title:"Users in your RWS"}},{path:"/telemetry",name:"telemetry",component:Tt,meta:{title:"Smart devices"}},{path:"/hasetup",name:"haSetup",component:Je,meta:{title:"HA setup"}},{path:"/services",name:"services",component:ke,meta:{title:"Services"}},{path:"/:pathMatch(.*)*",component:z}],Et=(0,M.p7)({history:(0,M.r5)(),routes:Lt});var zt=Et;const Bt=(0,D.MT)({state:{name:"Vue"}});var qt=Bt,Zt={install:e=>{e.config.globalProperties.$filters={balance(e,t,o){return"string"===typeof e||"number"===typeof e?`${w(e,t,4)} ${o}`:""}}}};window.Buffer=r.lW;const Vt=(0,n.ri)(A);Vt.use(zt).use(qt).use(Zt).use(P,{endpoint:"wss://kusama.rpc.robonomics.network/"}).use(R,{api:{gateway:"https://ipfs.url.today"},gateways:["https://ipfs.url.today/ipfs/","https://cf-ipfs.com/ipfs/","https://ipfs.io/ipfs/","https://gateway.pinata.cloud/ipfs/","https://gateway.ipfs.io/ipfs/","https://aira.mypinata.cloud/ipfs/"]}).use(a.robonomicsUI,{store:qt}).mount("#app")},95856:function(){},46601:function(){},63897:function(){},25819:function(){},24654:function(){},81265:function(){},35539:function(){},20173:function(){},55024:function(){}},t={};function o(r){var a=t[r];if(void 0!==a)return a.exports;var n=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(n.exports,n,n.exports,o),n.loaded=!0,n.exports}o.m=e,function(){o.amdO={}}(),function(){var e=[];o.O=function(t,r,a,n){if(!r){var s=1/0;for(c=0;c<e.length;c++){r=e[c][0],a=e[c][1],n=e[c][2];for(var i=!0,l=0;l<r.length;l++)(!1&n||s>=n)&&Object.keys(o.O).every((function(e){return o.O[e](r[l])}))?r.splice(l--,1):(i=!1,n<s&&(s=n));if(i){e.splice(c--,1);var u=a();void 0!==u&&(t=u)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[r,a,n]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};o.t=function(r,a){if(1&a&&(r=this(r)),8&a)return r;if("object"===typeof r&&r){if(4&a&&r.__esModule)return r;if(16&a&&"function"===typeof r.then)return r}var n=Object.create(null);o.r(n);var s={};e=e||[null,t({}),t([]),t(t)];for(var i=2&a&&r;"object"==typeof i&&!~e.indexOf(i);i=t(i))Object.getOwnPropertyNames(i).forEach((function(e){s[e]=function(){return r[e]}}));return s["default"]=function(){return r},o.d(n,s),n}}(),function(){o.d=function(e,t){for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){o.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={143:0};o.O.j=function(t){return 0===e[t]};var t=function(t,r){var a,n,s=r[0],i=r[1],l=r[2],u=0;if(s.some((function(t){return 0!==e[t]}))){for(a in i)o.o(i,a)&&(o.m[a]=i[a]);if(l)var c=l(o)}for(t&&t(r);u<s.length;u++)n=s[u],o.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return o.O(c)},r=self["webpackChunkdapp_robonomics_network"]=self["webpackChunkdapp_robonomics_network"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=o.O(void 0,[998],(function(){return o(8374)}));r=o.O(r)})();
//# sourceMappingURL=app.a077dcfa.js.map